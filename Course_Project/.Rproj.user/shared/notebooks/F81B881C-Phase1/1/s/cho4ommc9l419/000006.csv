"0",""
"0","chi_new$Hour = as.factor(case_when("
"0","  chi_new$Hour <=5 ~ 'Early_Morning',"
"0","  chi_new$Hour >=6 & chi_new$Hour <=11 ~ 'Morning',"
"0","  chi_new$Hour >=12 & chi_new$Hour <=17 ~ 'Afternoon',"
"0","  chi_new$Hour >=18 & chi_new$Hour <=24 ~ 'Night'"
"0","))"
"0",""
"0",""
"0","chi_new$Hour <- factor(chi_new$Hour, levels=c(""Early_Morning"", ""Morning"", ""Afternoon"", ""Night""))"
"0",""
"0","chi_new$Quarter = as.numeric(chi_new$Quarter)"
"0",""
"0","chi_new$Quarter = as.factor(case_when("
"0","  chi_new$Quarter <= 3 ~ 'Q1',"
"0","  chi_new$Quarter > 3 & chi_new$Quarter <=6 ~ 'Q2',"
"0","  chi_new$Quarter >= 7 & chi_new$Quarter <= 10 ~ 'Q3',"
"0","  chi_new$Quarter >= 10 & chi_new$Quarter <= 12 ~ 'Q4'"
"0","))"
"0",""
"0",""
"0",""
"0",""
"0","chi_new$Arrest = as.factor(case_when("
"0","  chi_new$Arrest == 'TRUE' ~ 'Arrest',"
"0","  chi_new$Arrest == 'FALSE' ~ 'NO_Arrest'"
"0","))"
"0",""
"0",""
"0",""
"0","chi_new$Offense <- paste(chi_new$`Primary Type`, chi_new$Description)"
"0",""
"0",""
"0","chi_new$Hour = as.factor(chi_new$Hour)"
"0","chi_new$`Primary Type` = as.factor(chi_new$`Primary Type`)"
"0","chi_new$`Location Description` = as.factor(chi_new$`Location Description`)"
"0",""
"0",""
"0","chi_new = chi_new[, -c(5, 6)]"
"0",""
"0",""
"0","chi_new <- "
"0","  chi_new %>% "
"0","  mutate("
"0","    Offense_new = case_when("
"0","      str_detect(Offense, 'ASSAULT AGG') ~ 'AGGREVATED ASSAULT',"
"0","      str_detect(Offense, 'ASSAULT SIMPLE|ASSAULT PRO') ~ 'SIMPLE ASSAULT',"
"0","      str_detect(Offense, 'BATTERY') ~ 'BATTERY',"
"0","      str_detect(Offense, 'BURGLARY') ~ 'BURGLARY',"
"0","      str_detect(Offense, 'CRIM SEXUAL') ~ 'CRIMINAL SEX OFFENSE',"
"0","      str_detect(Offense, 'CRIMINAL DAMAGE') ~ 'CRIMINAL DAMAGE',"
"0","      str_detect(Offense, 'CRIMINAL TRESPASS') ~ 'CRIMINAL TRESPASS',"
"0","      str_detect(Offense, 'DECEPTIVE PRACTICE') ~ 'DECEPTIVE PRACTICE',"
"0","      str_detect(Offense, 'HOMICIDE') ~ 'HOMICIDE',"
"0","      str_detect(Offense, 'INTERFERENCE') ~ 'INTERFERENCE',"
"0","      str_detect(Offense, 'MOTOR VEHICLE THEFT') ~ 'MOTOR VEHICLE THEFT',"
"0","      str_detect(Offense, 'NARCOTICS') ~ 'NARCOTICS',"
"0","      str_detect(Offense, 'OFFENSE INVOLVING CHILDREN') ~ 'OFFENSE INVOLVING CHILDREN',"
"0","      str_detect(Offense, 'OTHER OFFENSE') ~ 'OTHER OFFENSE',"
"0","      str_detect(Offense, 'PROSTITUTION') ~ 'PROSTITUTION',"
"0","      str_detect(Offense, 'PUBLIC PEACE') ~ 'PUBLIC PEACE',"
"0","      str_detect(Offense, 'ROBBERY') ~ 'ROBBERY',"
"0","      str_detect(Offense, 'SEX OFFENSE') ~ 'SEX OFFENSE',"
"0","      str_detect(Offense, 'THEFT') ~ 'THEFT',"
"0","      str_detect(Offense, 'WEAPONS VIOLATION') ~ 'WEAPONS VIOLATION'"
"0","      ))"
"0",""
"0","chi_new$Offense_new = as.factor(chi_new$Offense_new)"
"0",""
"0","#View(chi)"
"0",""
"0","chi_new$`Location Description` = case_when("
"0","      str_detect(chi_new$`Location Description`, 'SIDEWALK|STREET') ~ 'STREET',"
"0","      str_detect(chi_new$`Location Description`, 'AUTO|VEHICLE') ~ 'VEHICLE',"
"0","      str_detect(chi_new$`Location Description`, 'BANK') ~ 'BANK',"
"0","      str_detect(chi_new$`Location Description`, 'BOAT|LAKE') ~ 'WATER_LOCATION',"
"0","      str_detect(chi_new$`Location Description`, 'BRIDGE') ~ 'BRIDGE',"
"0","      str_detect(chi_new$`Location Description`, 'CHURCH') ~ 'PLACE OF WORSHIP',"
"0","      str_detect(chi_new$`Location Description`, 'COLLEGE') ~ 'COLLEGE_UNIVERSITY',"
"0","      str_detect(chi_new$`Location Description`, 'CTA') ~ 'CTA_LOCATION',"
"0","      str_detect(chi_new$`Location Description`, 'FEDERAL|GOVERNMENT|POLICE|FIRE') ~ 'GOVT BUILDING',"
"0","      str_detect(chi_new$`Location Description`, 'HIGHWAY') ~ 'HIGHWAY',"
"0","      str_detect(chi_new$`Location Description`, 'JAIL') ~ 'JAIL',"
"0","      str_detect(chi_new$`Location Description`, 'FOREST|PARK PROPERTY') ~ 'PARK',"
"0","      str_detect(chi_new$`Location Description`, 'PARKING LOT') ~ 'PARKING LOT',"
"0","      str_detect(chi_new$`Location Description`, 'SCHOOL') ~ 'SCHOOL',"
"0","      str_detect(chi_new$`Location Description`, 'SPORTS') ~ 'SPORTING ARENA',"
"0","      str_detect(chi_new$`Location Description`, 'TAXI') ~ 'TAXI',"
"0","      str_detect(chi_new$`Location Description`, 'STORE|CLUB|BAR|BOWLING|CAR WASH|COMMERCIAL|CONSTRUCTION SITE|DAY CARE CENTER|FACTORY|GAS STATION|LIBRARY|THEATER|SHOP|RESTAURANT|SAVINGS AND LOAN|ATM|CURRENCY EXCHANGE') ~ 'STORE',"
"0","      str_detect(chi_new$`Location Description`, 'APARTMENT|DRIVEWAY|HALLWAY|HOTEL|HOUSE|NURSING HOME|PORCH|POOL ROOM|RESIDENCE|RESIDENTIAL|YARD') ~ 'RESIDENTIAL',"
"0","      str_detect(chi_new$`Location Description`, 'AIR') ~ 'AIRPORT',"
"0","      str_detect(chi_new$`Location Description`, 'HOSPITAL|MEDICAL') ~ 'HOSPITAL',"
"0","      str_detect(chi_new$`Location Description`, 'OTHER|ABANDONED BUILDING|ALLEY|VACANT|WAREHOUSE') ~ 'OTHER'"
"0","      )"
"0",""
"0","colnames(chi_new)[5]= 'location_description'"
"0","  "
"0","chi_new$location_description = as.factor(chi_new$location_description)"
"0",""
"0",""
"0","chi_new$District = case_when("
"0","  chi_new$District == '001' ~ 1,"
"0","  chi_new$District == '002' ~ 2,"
"0","  chi_new$District == '003' ~ 3,"
"0","  chi_new$District == '004' ~ 4,"
"0","  chi_new$District == '005' ~ 5,"
"0","  chi_new$District == '006' ~ 6,"
"0","  chi_new$District == '007' ~ 7,"
"0","  chi_new$District == '008' ~ 8,"
"0","  chi_new$District == '009' ~ 9,"
"0","  chi_new$District == '010' ~ 10,"
"0","  chi_new$District == '011' ~ 11,"
"0","  chi_new$District == '012' ~ 12,"
"0","  chi_new$District == '013' ~ 13,"
"0","  chi_new$District == '014' ~ 14,"
"0","  chi_new$District == '015' ~ 15,"
"0","  chi_new$District == '016' ~ 16,"
"0","  chi_new$District == '017' ~ 17,"
"0","  chi_new$District == '018' ~ 18,"
"0","  chi_new$District == '019' ~ 19,"
"0","  chi_new$District == '020' ~ 20,"
"0","  chi_new$District == '021' ~ 21,"
"0","  chi_new$District == '022' ~ 22,"
"0","  chi_new$District == '023' ~ 23,"
"0","  chi_new$District == '024' ~ 24,"
"0","  chi_new$District == '025' ~ 25,"
"0",")"
"0",""
"0","chi_new = chi_new %>% group_by(chi_new$location_description) %>% filter(n() > 20)"
"0",""
"0","chi_new <- drop_na(chi_new)"
"0",""
