labs(title= "blank title", x = "Offense", y ="Count", caption="Y-Axis on Log10 Scale")
offense_arrest_plotly <- ggplotly(offense_arrest, tooltip = FALSE) %>%
layout(title = list(text = paste0('Offense VS Arrest Status',
'<br>',
'<sup>',
'Y-Axis on Log10 Scale',
'<br>',
'</sup>')))
offense_arrest_plotly
offense_arrest <- ggplot(chi_new, aes(Offense_new, fill = Arrest)) +
geom_bar(y=..count../sum(..count)) +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
#scale_y_log10() +
scale_fill_manual(values = c("dark grey", "light blue")) +
labs(title= "blank title", x = "Offense", y ="Count", caption="Y-Axis on Log10 Scale")
offense_arrest <- ggplot(chi_new, aes(Offense_new, fill = Arrest)) +
geom_bar(y=..count../sum(..count..)) +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
#scale_y_log10() +
scale_fill_manual(values = c("dark grey", "light blue")) +
labs(title= "blank title", x = "Offense", y ="Count", caption="Y-Axis on Log10 Scale")
offense_arrest <- ggplot(chi_new, aes(Offense_new, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count..)), position = "dodge") +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
#scale_y_log10() +
scale_fill_manual(values = c("dark grey", "light blue")) +
labs(title= "blank title", x = "Offense", y ="Count", caption="Y-Axis on Log10 Scale")
offense_arrest_plotly <- ggplotly(offense_arrest, tooltip = FALSE) %>%
layout(title = list(text = paste0('Offense VS Arrest Status',
'<br>',
'<sup>',
'Y-Axis on Log10 Scale',
'<br>',
'</sup>')))
offense_arrest_plotly
offense_arrest <- ggplot(chi_new, aes(Offense_new, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count..))) +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
#scale_y_log10() +
scale_fill_manual(values = c("dark grey", "light blue")) +
labs(title= "blank title", x = "Offense", y ="Count", caption="Y-Axis on Log10 Scale")
offense_arrest_plotly <- ggplotly(offense_arrest, tooltip = FALSE) %>%
layout(title = list(text = paste0('Offense VS Arrest Status',
'<br>',
'<sup>',
'Y-Axis on Log10 Scale',
'<br>',
'</sup>')))
offense_arrest_plotly
offense_arrest <- ggplot(chi_new, aes(Offense_new, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count..))) +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
scale_y_continuous(labels = percent_format())
offense_arrest_plotly <- ggplotly(offense_arrest, tooltip = FALSE) %>%
layout(title = list(text = paste0('Offense VS Arrest Status',
'<br>',
'<sup>',
'Y-Axis on Log10 Scale',
'<br>',
'</sup>')))
offense_arrest_plotly
offense_arrest <- ggplot(chi_new, aes(Offense_new, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count..))) +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
scale_y_continuous(labels = percent_format()) +
#scale_y_log10() +
scale_fill_manual(values = c("dark grey", "light blue")) +
labs(title= "blank title", x = "Offense", y ="Count", caption="Y-Axis on Log10 Scale")
offense_arrest_plotly <- ggplotly(offense_arrest, tooltip = FALSE) %>%
layout(title = list(text = paste0('Offense VS Arrest Status',
'<br>',
'<sup>',
'Y-Axis on Log10 Scale',
'<br>',
'</sup>')))
offense_arrest_plotly
deployApp()
install.packages("rsconnect")
library(rsconnect)
deployApp()
deployApp()
offense_arrest <- ggplot(chi_new, aes(Offense_new, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count..))) +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
scale_y_continuous(labels = percent_format()) +
#scale_y_log10() +
scale_fill_manual(values = c("dark grey", "light blue")) +
labs(title= "Offense VS Arrest Status", x = "Offense", y ="Count", caption="Y-Axis on Log10 Scale")
ggplotly(offense_arrest, tooltip =FALSE)
```{r}
location_arrest <- ggplot(chi_new, aes(location_description, fill = Arrest)) +
geom_bar(position = "dodge") +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
scale_fill_manual(values = c("dark grey", "light blue")) +
scale_y_log10() +
labs(title= "blank title", x = "Offense Location", y ="Count", caption="Y-Axis on Log10 Scale")
location_arrest_plotly <- ggplotly(location_arrest, tooltip = FALSE) %>%
layout(title = list(text = paste0('Offense Location VS Arrest Status',
'<br>',
'<sup>',
'Y-Axis on Log10 Scale',
'<br>',
'</sup>')))
location_arrest_plotly
location_arrest <- ggplot(chi_new, aes(location_description, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count..)),position = "dodge") +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
scale_fill_manual(values = c("dark grey", "light blue")) +
labs(title= "blank title", x = "Offense Location", y ="Count", caption="Y-Axis on Log10 Scale")
location_arrest_plotly <- ggplotly(location_arrest, tooltip = FALSE) %>%
layout(title = list(text = paste0('Offense Location VS Arrest Status',
'<br>',
'<sup>',
'Y-Axis on Log10 Scale',
'<br>',
'</sup>')))
location_arrest_plotly
location_arrest <- ggplot(chi_new, aes(location_description, fill = Arrest)) +
geom_bar(position = "dodge") +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
scale_fill_manual(values = c("dark grey", "light blue")) +
scale_y_log10() +
labs(title= "blank title", x = "Offense Location", y ="Count", caption="Y-Axis on Log10 Scale")
location_arrest_plotly <- ggplotly(location_arrest, tooltip = FALSE) %>%
layout(title = list(text = paste0('Offense Location VS Arrest Status',
'<br>',
'<sup>',
'Y-Axis on Log10 Scale',
'<br>',
'</sup>')))
location_arrest_plotly
deployApp()
hour_arrest <- ggplot(chi_new, aes(Arrest, fill = Hour)) +
geom_bar(aes(y=..count../sum(..count..)), position = "dodge") +
#geom_bar(position = "dodge") +
theme_gdocs() +
scale_fill_brewer(type = "seq", palette = "YlOrRd") +
scale_y_continuous(labels=percent_format()) +
#scale_fill_manual(values = c("orange", "light blue", "yellow", "dark grey")) +
labs(title = "Time of Offense VS Arrest Status", X= "Arrest Status", y ="Percent")
#+  facet_wrap(~ Hour, nrow = 2)
hour_arrest_plotly <- ggplotly(hour_arrest, tooltip = FALSE)
hour_arrest_plotly
hour_arrest <- ggplot(chi_new, aes(Arrest, fill = Hour)) +
geom_bar(aes(y=..count../sum(..count..)), position = "dodge") +
#geom_bar(position = "dodge") +
theme_gdocs() +
scale_fill_brewer(type = "seq", palette = "YlOrRd") +
scale_y_continuous(labels=percent_format()) +
#scale_fill_manual(values = c("orange", "light blue", "yellow", "dark grey")) +
labs(title = "Time of Offense VS Arrest Status", X= "Arrest Status", y ="Percent")
hour_arrest_plotly <- ggplotly(hour_arrest, tooltip = FALSE)
hour_arrest_plotly
hour_arrest <- ggplot(chi_new, aes(Arrest, fill = Hour)) +
geom_bar(aes(y=..count../sum(..count..)), position = "dodge") +
#geom_bar(position = "dodge") +
theme_gdocs() +
scale_fill_brewer(type = "seq", palette = "YlOrRd") +
scale_y_continuous(labels=percent_format()) +
#scale_fill_manual(values = c("orange", "light blue", "yellow", "dark grey")) +
labs(title = "Time of Offense VS Arrest Status", x="Arrest Status", y="Percent")
hour_arrest_plotly <- ggplotly(hour_arrest, tooltip = FALSE)
hour_arrest_plotly
quarter_arrest <- ggplot(chi_new, aes(Arrest, fill = Quarter)) +
geom_bar(aes(y=..count../sum(..count..)), position = "dodge") +
#geom_bar(position = "dodge") +
theme_gdocs() +
scale_fill_brewer(type = "seq", palette = "YlOrRd") +
scale_y_continuous(labels=percent_format()) +
#scale_fill_manual(values = c("orange", "light blue", "yellow", "dark grey")) +
labs(title = "Quarter VS Arrest Status", x= "Arrest Status", y ="Percent")
quarter_arrest_plotly <- ggplotly(quarter_arrest, tooltip = FALSE)
quarter_arrest_plotly
hour_arrest <- ggplot(chi_new, aes(Arrest, fill = Hour)) +
geom_bar(aes(y=..count../sum(..count..)), position = "dodge") +
#geom_bar(position = "dodge") +
theme_gdocs() +
scale_fill_brewer(type = "seq", palette = "YlOrRd") +
scale_y_continuous(breaks = c(0:.3, .05), labels=percent_format()) +
#scale_fill_manual(values = c("orange", "light blue", "yellow", "dark grey")) +
labs(title = "Time of Offense VS Arrest Status", x="Arrest Status", y="Percent")
hour_arrest_plotly <- ggplotly(hour_arrest, tooltip = FALSE)
hour_arrest_plotly
hour_arrest <- ggplot(chi_new, aes(Arrest, fill = Hour)) +
geom_bar(aes(y=..count../sum(..count..)), position = "dodge") +
#geom_bar(position = "dodge") +
theme_gdocs() +
scale_fill_brewer(type = "seq", palette = "YlOrRd") +
scale_y_continuous(breaks = c(0,.5), labels=percent_format()) +
#scale_fill_manual(values = c("orange", "light blue", "yellow", "dark grey")) +
labs(title = "Time of Offense VS Arrest Status", x="Arrest Status", y="Percent")
hour_arrest_plotly <- ggplotly(hour_arrest, tooltip = FALSE)
hour_arrest_plotly
hour_arrest <- ggplot(chi_new, aes(Arrest, fill = Hour)) +
geom_bar(aes(y=..count../sum(..count..)), position = "dodge") +
#geom_bar(position = "dodge") +
theme_gdocs() +
scale_fill_brewer(type = "seq", palette = "YlOrRd") +
scale_y_continuous(limits = c(0, .5), labels=percent_format()) +
#scale_fill_manual(values = c("orange", "light blue", "yellow", "dark grey")) +
labs(title = "Time of Offense VS Arrest Status", x="Arrest Status", y="Percent")
hour_arrest_plotly <- ggplotly(hour_arrest, tooltip = FALSE)
hour_arrest_plotly
hour_arrest <- ggplot(chi_new, aes(Arrest, fill = Hour)) +
geom_bar(aes(y=..count../sum(..count..)), position = "dodge") +
#geom_bar(position = "dodge") +
theme_gdocs() +
scale_fill_brewer(type = "seq", palette = "YlOrRd") +
scale_y_continuous(limits = c(0, .30), labels=percent_format()) +
#scale_fill_manual(values = c("orange", "light blue", "yellow", "dark grey")) +
labs(title = "Time of Offense VS Arrest Status", x="Arrest Status", y="Percent")
hour_arrest_plotly <- ggplotly(hour_arrest, tooltip = FALSE)
hour_arrest_plotly
offense_arrest <- ggplot(chi_new, aes(Offense_new, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count..))) +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
scale_y_continuous(limits = c(0, .30), labels=percent_format()) +
#scale_y_log10() +
scale_fill_manual(values = c("dark grey", "light blue")) +
labs(title= "Offense VS Arrest Status", x = "Offense", y ="Count", caption="Y-Axis on Log10 Scale")
ggplotly(offense_arrest, tooltip =FALSE)
offense_arrest <- ggplot(chi_new, aes(Offense_new, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count..))) +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
scale_y_continuous(limits = c(0, .25), labels=percent_format()) +
#scale_y_log10() +
scale_fill_manual(values = c("dark grey", "light blue")) +
labs(title= "Offense VS Arrest Status", x = "Offense", y ="Count", caption="Y-Axis on Log10 Scale")
ggplotly(offense_arrest, tooltip =FALSE)
quarter_arrest <- ggplot(chi_new, aes(Arrest, fill = Quarter)) +
geom_bar(aes(y=..count../sum(..count..)), position = "dodge") +
#geom_bar(position = "dodge") +
theme_gdocs() +
scale_fill_brewer(type = "seq", palette = "YlOrRd") +
scale_y_continuous(limits = c(0, .30), labels=percent_format()) +
#scale_fill_manual(values = c("orange", "light blue", "yellow", "dark grey")) +
labs(title = "Quarter VS Arrest Status", x= "Arrest Status", y ="Percent")
quarter_arrest_plotly <- ggplotly(quarter_arrest, tooltip = FALSE)
quarter_arrest_plotly
hour_arrest_plotly
ggplotly(offense_arrest, tooltip =FALSE)
offense_arrest <- ggplot(chi_new, aes(Offense_new, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count..))) +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
scale_y_continuous(limits = c(0, .25), labels=percent_format()) +
#scale_y_log10() +
scale_fill_manual(values = c("dark grey", "light blue")) +
labs(title= "Offense VS Arrest Status", x = "Offense", y ="Percent", caption="Y-Axis on Log10 Scale")
offense_arrest <- ggplot(chi_new, aes(Offense_new, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count..))) +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
scale_y_continuous(limits = c(0, .25), labels=percent_format()) +
#scale_y_log10() +
scale_fill_manual(values = c("dark grey", "light blue")) +
labs(title= "Offense VS Arrest Status", x = "Offense", y ="Percent")
ggplotly(offense_arrest, tooltip =FALSE)
hour_arrest_plotly
quarter_arrest <- ggplot(chi_new, aes(Arrest, fill = Quarter)) +
geom_bar(aes(y=..count../sum(..count..)), position = "dodge") +
#geom_bar(position = "dodge") +
theme_gdocs() +
scale_fill_brewer(type = "seq", palette = "YlOrRd") +
scale_y_continuous(limits = c(0, .30), labels=percent_format()) +
#scale_fill_manual(values = c("orange", "light blue", "yellow", "dark grey")) +
labs(title = "Quarter VS Arrest Status", x= "Arrest Status", y ="Percent")
quarter_arrest_plotly <- ggplotly(quarter_arrest, tooltip = FALSE)
quarter_arrest_plotly
location_arrest <- ggplot(chi_new, aes(location_description, fill = Arrest)) +
geom_bar(position = "dodge") +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
scale_fill_manual(values = c("dark grey", "light blue")) +
scale_y_log10() +
labs(title= "blank title", x = "Offense Location", y ="Count", caption="Y-Axis on Log10 Scale")
location_arrest_plotly <- ggplotly(location_arrest, tooltip = FALSE) %>%
layout(title = list(text = paste0('Offense Location VS Arrest Status',
'<br>',
'<sup>',
'Y-Axis on Log10 Scale',
'<br>',
'</sup>')))
location_arrest_plotly
deployApp()
#install.packages(c("flexdashboard", "ggplot2", "tidyverse", "lubridate", "corrplot", "ggthemes", "plotly", #"RColorBrewer"))
#require(devtools); install_version("rmarkdown", version = "1.17", repos = "http://cran.us.r-project.org")
library(flexdashboard)
library(ggplot2)
library(tidyverse)
library(lubridate)
library(corrplot)
library(ggthemes)
library(plotly)
library(RColorBrewer)
library(scales)
district_arrest <- ggplot(chi_new, aes(District, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count))) + theme(axis.text.x = element_text(vjust = 0.5,
angle = 90)) +
scale_fill_manual(values = c("dark grey", "light blue"))  +
theme_gdocs()+
scale_x_continuous(breaks = c(1:25, 0)) +
labs(title="Police District VS Arrest Status", y="Count", x="Police District")
ggplotly(district_arrest)
library(flexdashboard)
library(ggplot2)
library(tidyverse)
library(lubridate)
library(corrplot)
library(ggthemes)
library(plotly)
library(RColorBrewer)
library(scales)
offense_arrest <- ggplot(chi_new, aes(Offense_new, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count..))) +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
scale_y_continuous(limits = c(0, .25), labels=percent_format()) +
#scale_y_log10() +
scale_fill_manual(values = c("dark grey", "light blue")) +
labs(title= "Offense VS Arrest Status", x = "Offense", y ="Percent")
ggplotly(offense_arrest, tooltip =FALSE)
district_arrest <- ggplot(chi_new, aes(District, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count))) + theme(axis.text.x = element_text(vjust = 0.5,
angle = 90)) +
scale_fill_manual(values = c("dark grey", "light blue"))  +
theme_gdocs()+
scale_x_continuous(breaks = c(1:25, 0)) +
labs(title="Police District VS Arrest Status", y="Count", x="Police District")
ggplotly(district_arrest)
district_arrest
district_arrest <- ggplot(chi_new, aes(District, fill = Arrest)) +
labs(title="Police District VS Arrest Status", y="Count", x="Police District")
district_arrest
quarter_arrest <- ggplot(chi_new, aes(Arrest, fill = Quarter)) +
geom_bar(aes(y=..count../sum(..count..)), position = "dodge") +
#geom_bar(position = "dodge") +
theme_gdocs() +
scale_fill_brewer(type = "seq", palette = "YlOrRd") +
scale_y_continuous(limits = c(0, .30), labels=percent_format()) +
#scale_fill_manual(values = c("orange", "light blue", "yellow", "dark grey")) +
labs(title = "Quarter VS Arrest Status", x= "Arrest Status", y ="Percent")
quarter_arrest_plotly <- ggplotly(quarter_arrest, tooltip = FALSE)
quarter_arrest_plotly
chi_new$Hour = as.factor(case_when(
chi_new$Hour <=5 ~ 'Early_Morning',
chi_new$Hour >=6 & chi_new$Hour <=11 ~ 'Morning',
chi_new$Hour >=12 & chi_new$Hour <=17 ~ 'Afternoon',
chi_new$Hour >=18 & chi_new$Hour <=24 ~ 'Night'
))
chi_new$Hour <- factor(chi_new$Hour, levels=c("Early_Morning", "Morning", "Afternoon", "Night"))
chi_new$Quarter = as.numeric(chi_new$Quarter)
chi_new$Quarter = as.factor(case_when(
chi_new$Quarter <= 3 ~ 'Q1',
chi_new$Quarter > 3 & chi_new$Quarter <=6 ~ 'Q2',
chi_new$Quarter >= 7 & chi_new$Quarter <= 10 ~ 'Q3',
chi_new$Quarter >= 10 & chi_new$Quarter <= 12 ~ 'Q4'
))
chi_new$Arrest = as.factor(case_when(
chi_new$Arrest == 'TRUE' ~ 'Arrest',
chi_new$Arrest == 'FALSE' ~ 'NO_Arrest'
))
chi_new$Offense <- paste(chi_new$`Primary Type`, chi_new$Description)
chi_new$Offense <- paste(chi_new$`Primary Type`, chi_new$Description)
chi <- read_csv("chicago2.csv")
#head(chi)
chi = chi[, -c(2,3, 17, 18, 20, 23)]
chi = chi %>% mutate(Date = mdy_hms(Date))
#head(chi)
chi = chi %>% mutate(Hour = hour(Date))
# Creating chi_new df
chi_new = chi %>% group_by(chi$`Primary Type`) %>% filter(n() > 20)
chi_new$Quarter = format(chi_new$Date, "%m")
chi_new = chi_new[, -c(19)]
chi_new$Hour = as.factor(case_when(
chi_new$Hour <=5 ~ 'Early_Morning',
chi_new$Hour >=6 & chi_new$Hour <=11 ~ 'Morning',
chi_new$Hour >=12 & chi_new$Hour <=17 ~ 'Afternoon',
chi_new$Hour >=18 & chi_new$Hour <=24 ~ 'Night'
))
chi_new$Hour <- factor(chi_new$Hour, levels=c("Early_Morning", "Morning", "Afternoon", "Night"))
chi_new$Quarter = as.numeric(chi_new$Quarter)
chi_new$Quarter = as.factor(case_when(
chi_new$Quarter <= 3 ~ 'Q1',
chi_new$Quarter > 3 & chi_new$Quarter <=6 ~ 'Q2',
chi_new$Quarter >= 7 & chi_new$Quarter <= 10 ~ 'Q3',
chi_new$Quarter >= 10 & chi_new$Quarter <= 12 ~ 'Q4'
))
chi_new$Arrest = as.factor(case_when(
chi_new$Arrest == 'TRUE' ~ 'Arrest',
chi_new$Arrest == 'FALSE' ~ 'NO_Arrest'
))
chi_new$Offense <- paste(chi_new$`Primary Type`, chi_new$Description)
chi_new$Hour = as.factor(chi_new$Hour)
chi_new$`Primary Type` = as.factor(chi_new$`Primary Type`)
chi_new$`Location Description` = as.factor(chi_new$`Location Description`)
chi_new = chi_new[, -c(5, 6)]
chi_new <-
chi_new %>%
mutate(
Offense_new = case_when(
str_detect(Offense, 'ASSAULT AGG') ~ 'AGGREVATED ASSAULT',
str_detect(Offense, 'ASSAULT SIMPLE|ASSAULT PRO') ~ 'SIMPLE ASSAULT',
str_detect(Offense, 'BATTERY') ~ 'BATTERY',
str_detect(Offense, 'BURGLARY') ~ 'BURGLARY',
str_detect(Offense, 'CRIM SEXUAL') ~ 'CRIMINAL SEX OFFENSE',
str_detect(Offense, 'CRIMINAL DAMAGE') ~ 'CRIMINAL DAMAGE',
str_detect(Offense, 'CRIMINAL TRESPASS') ~ 'CRIMINAL TRESPASS',
str_detect(Offense, 'DECEPTIVE PRACTICE') ~ 'DECEPTIVE PRACTICE',
str_detect(Offense, 'HOMICIDE') ~ 'HOMICIDE',
str_detect(Offense, 'INTERFERENCE') ~ 'INTERFERENCE',
str_detect(Offense, 'MOTOR VEHICLE THEFT') ~ 'MOTOR VEHICLE THEFT',
str_detect(Offense, 'NARCOTICS') ~ 'NARCOTICS',
str_detect(Offense, 'OFFENSE INVOLVING CHILDREN') ~ 'OFFENSE INVOLVING CHILDREN',
str_detect(Offense, 'OTHER OFFENSE') ~ 'OTHER OFFENSE',
str_detect(Offense, 'PROSTITUTION') ~ 'PROSTITUTION',
str_detect(Offense, 'PUBLIC PEACE') ~ 'PUBLIC PEACE',
str_detect(Offense, 'ROBBERY') ~ 'ROBBERY',
str_detect(Offense, 'SEX OFFENSE') ~ 'SEX OFFENSE',
str_detect(Offense, 'THEFT') ~ 'THEFT',
str_detect(Offense, 'WEAPONS VIOLATION') ~ 'WEAPONS VIOLATION'
))
chi_new$Offense_new = as.factor(chi_new$Offense_new)
#View(chi)
chi_new$`Location Description` = case_when(
str_detect(chi_new$`Location Description`, 'SIDEWALK|STREET') ~ 'STREET',
str_detect(chi_new$`Location Description`, 'AUTO|VEHICLE') ~ 'VEHICLE',
str_detect(chi_new$`Location Description`, 'BANK') ~ 'BANK',
str_detect(chi_new$`Location Description`, 'BOAT|LAKE') ~ 'WATER_LOCATION',
str_detect(chi_new$`Location Description`, 'BRIDGE') ~ 'BRIDGE',
str_detect(chi_new$`Location Description`, 'CHURCH') ~ 'PLACE OF WORSHIP',
str_detect(chi_new$`Location Description`, 'COLLEGE') ~ 'COLLEGE_UNIVERSITY',
str_detect(chi_new$`Location Description`, 'CTA') ~ 'CTA_LOCATION',
str_detect(chi_new$`Location Description`, 'FEDERAL|GOVERNMENT|POLICE|FIRE') ~ 'GOVT BUILDING',
str_detect(chi_new$`Location Description`, 'HIGHWAY') ~ 'HIGHWAY',
str_detect(chi_new$`Location Description`, 'JAIL') ~ 'JAIL',
str_detect(chi_new$`Location Description`, 'FOREST|PARK PROPERTY') ~ 'PARK',
str_detect(chi_new$`Location Description`, 'PARKING LOT') ~ 'PARKING LOT',
str_detect(chi_new$`Location Description`, 'SCHOOL') ~ 'SCHOOL',
str_detect(chi_new$`Location Description`, 'SPORTS') ~ 'SPORTING ARENA',
str_detect(chi_new$`Location Description`, 'TAXI') ~ 'TAXI',
str_detect(chi_new$`Location Description`, 'STORE|CLUB|BAR|BOWLING|CAR WASH|COMMERCIAL|CONSTRUCTION SITE|DAY CARE CENTER|FACTORY|GAS STATION|LIBRARY|THEATER|SHOP|RESTAURANT|SAVINGS AND LOAN|ATM|CURRENCY EXCHANGE') ~ 'STORE',
str_detect(chi_new$`Location Description`, 'APARTMENT|DRIVEWAY|HALLWAY|HOTEL|HOUSE|NURSING HOME|PORCH|POOL ROOM|RESIDENCE|RESIDENTIAL|YARD') ~ 'RESIDENTIAL',
str_detect(chi_new$`Location Description`, 'AIR') ~ 'AIRPORT',
str_detect(chi_new$`Location Description`, 'HOSPITAL|MEDICAL') ~ 'HOSPITAL',
str_detect(chi_new$`Location Description`, 'OTHER|ABANDONED BUILDING|ALLEY|VACANT|WAREHOUSE') ~ 'OTHER'
)
colnames(chi_new)[5]= 'location_description'
chi_new$location_description = as.factor(chi_new$location_description)
chi_new$District = case_when(
chi_new$District == '001' ~ 1,
chi_new$District == '002' ~ 2,
chi_new$District == '003' ~ 3,
chi_new$District == '004' ~ 4,
chi_new$District == '005' ~ 5,
chi_new$District == '006' ~ 6,
chi_new$District == '007' ~ 7,
chi_new$District == '008' ~ 8,
chi_new$District == '009' ~ 9,
chi_new$District == '010' ~ 10,
chi_new$District == '011' ~ 11,
chi_new$District == '012' ~ 12,
chi_new$District == '013' ~ 13,
chi_new$District == '014' ~ 14,
chi_new$District == '015' ~ 15,
chi_new$District == '016' ~ 16,
chi_new$District == '017' ~ 17,
chi_new$District == '018' ~ 18,
chi_new$District == '019' ~ 19,
chi_new$District == '020' ~ 20,
chi_new$District == '021' ~ 21,
chi_new$District == '022' ~ 22,
chi_new$District == '023' ~ 23,
chi_new$District == '024' ~ 24,
chi_new$District == '025' ~ 25,
)
chi_new = chi_new %>% group_by(chi_new$location_description) %>% filter(n() > 20)
chi_new <- drop_na(chi_new)
offense_arrest <- ggplot(chi_new, aes(Offense_new, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count..))) +
theme_gdocs()  + theme(axis.text.x = element_text(angle = 30)) +
scale_y_continuous(limits = c(0, .25), labels=percent_format()) +
#scale_y_log10() +
scale_fill_manual(values = c("dark grey", "light blue")) +
labs(title= "Offense VS Arrest Status", x = "Offense", y ="Percent")
#location_arrest
ggplotly(offense_arrest, tooltip =FALSE)
hour_arrest <- ggplot(chi_new, aes(Arrest, fill = Hour)) +
geom_bar(aes(y=..count../sum(..count..)), position = "dodge") +
#geom_bar(position = "dodge") +
theme_gdocs() +
scale_fill_brewer(type = "seq", palette = "YlOrRd") +
scale_y_continuous(limits = c(0, .30), labels=percent_format()) +
#scale_fill_manual(values = c("orange", "light blue", "yellow", "dark grey")) +
labs(title = "Time of Offense VS Arrest Status", x="Arrest Status", y="Percent")
hour_arrest_plotly <- ggplotly(hour_arrest, tooltip = FALSE)
hour_arrest_plotly
district_arrest <- ggplot(chi_new, aes(District, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count))) + theme(axis.text.x = element_text(vjust = 0.5,
angle = 90)) +
scale_fill_manual(values = c("dark grey", "light blue"))  +
theme_gdocs()+
scale_x_continuous(breaks = c(1:25, 0)) +
labs(title="Police District VS Arrest Status", y="Count", x="Police District")
district_arrest
district_arrest <- ggplot(chi_new, aes(District, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count))) + theme(axis.text.x = element_text(vjust = 0.5,
angle = 90)) +
scale_fill_manual(values = c("dark grey", "light blue"))  +
theme_gdocs()+
scale_x_continuous(breaks = c(1:25, 0)) +
labs(title="Police District VS Arrest Status", y="Count", x="Police District")
district_arrest <- ggplot(chi_new, aes(District, fill = Arrest)) +
geom_bar(aes(y=..count../sum(..count))) + theme(axis.text.x = element_text(vjust = 0.5,
angle = 90))
district_arrest
