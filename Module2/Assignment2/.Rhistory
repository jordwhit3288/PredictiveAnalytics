install.packages("tidyverse")
library(tidyverse)
install.packages("GGally")
library(GGally)
install.packages("MASS")
library(MASS)
install.packages("car")
library(car)
install.packages("gridExtra")
library(gridExtra)
bike = read_csv("hour.csv")
View(bike)
bike = bike %>% mutate(season = as_factor(as.character(season))) %>%
mutate(season = fct_recode(season,
"Spring" = "1",
"Summer" = "2",
"Fall" = "3",
"Winter" = "4"))
head(bike)
mutate(yr = fct_recode(yr)
bike = bike %>% mutate(season = as_factor(as.character(yr))) %>%
bike = bike %>% mutate(season = as_factor(as.character(yr))) %>%
mutate(yr = fct_recode(yr))
bike = bike %>% mutate(season = as_factor(as.character(yr))) %>%
mutate(yr = fct_recode(yr))
bike = bike %>% mutate(yr = as_factor(as.character(yr))) %>%
mutate(yr = fct_recode(yr))
head(bike)
bike = bike %>% mutate(mnth = as_factor(as.character(mnth))) %>%
mutate(mnth = fct_recode(mnth))
bike = bike %>% mutate(hr = as_factor(as.character(hr))) %>%
mutate(hr = fct_recode(hr))
head(bike)
bike = bike %>% mutate(workingday = as_factor(as.character(workingday))) %>%
mutate(workingday = fct_recode(workingday,
"NotWorkingDay" = "0",
"WorkingDay" = "1",))
head(bike)
View(bike)
head(bike)
bike = bike %>% mutate(weathersit = as_factor(as.character(weathersit))) %>%
mutate(weathersit = fct_recode(weathersit,
"NoPrecip" = "1",
"Misty" = "2",
"LightPrecip" = "3",
"HeavyPrecip" = "4"))
head(bike)
View(bike)
bike = bike %>% mutate(weekday = as_factor(as.character(weekday))) %>%
mutate(weekday = fct_recode(weekday,
"Monday" = "1",
"Tuesday" = "2",
"Wednesday" = "3",
"Thursday" = "4",
"Friday" = "5",
"Saturday" = "6",
"Sunday"= "0"))
head(bike)
ggpairs(bike, label=TRUE)
bike_quant <- bike %>%
select(holiday, tmep, atemp, hum, windspeed, count)
bike_quant = bike %>% dplyr::select(holiday, tmep, atemp, hum, windspeed, count)
bike_quant = bike %>% dplyr::select(holiday, temp, atemp, hum, windspeed, count)
ggpairs(bike_quant, label=TRUE)
head(bike)
ggplot(bike, aes(x=season, y=count)) +
geom_boxplot()
season_plt <- ggplot(bike, aes(x=season, y=count)) +
geom_boxplot()
head(bike)
yr_plt <- ggplot(bike, aes(x=yr, y=count)) +
geom_boxplot()
yr_plt
mnth_plt <- ggplot(bike, aes(x=mnth, y=count)) +
geom_boxplot()
mnth_plt
hr_plt <- ggplot(bike, aes(x=hr, y=count)) +
geom_boxplot()
hr_plt
weather_plt <- ggplot(bike, aes(x=weathersit, y=count)) +
geom_boxplot()
weather_plt
workingdy_plt <- ggplot(bike, aes(x=workingday, y=count)) +
geom_boxplot()
workingdy_plt
weekdy_plt <- ggplot(bike, aes(x=weekday, y=count)) +
geom_boxplot()
weekdy_plt
grid.arrange(season_plt, yr_plt, mnth_plt, hr_plt, weekdy_plt, workingdy_plt, weather_plt, nrow= 3 )
allmod = lm(count ~., bike)
summary(allmod)
emptymod = lm(count -1, bike)
emptymod = lm(count ~1, bike)
summary(emptymod)
forwardmod = stepAIC(emptymod, direction='forward', scope=list(upper=allmod,lower=emptymod),
trace = TRUE)
summary(forwardmod)
bike = bike %>% dplyr::select(-c(instant, dteday, registered, casual))
allmod = lm(count ~., bike)
summary(allmod)
summary(allmod)
emptymod = lm(count ~1, bike)
summary(emptymod)
forwardmod = stepAIC(emptymod, direction='forward', scope=list(upper=allmod,lower=emptymod),
trace = TRUE)
summary(forwardmod)
vif(forwardmod)
backmod = stepAIC(allmod, direction = "backward", trace = TRUE)
summary(backmod)
allmod
summary(allmod)
summary(forwardmod)
options(tidyverse.quiet = TRUE)
bike = bike %>% dplyr::select(-c(instant, dteday, registered, casual))
bike = bike %>% dplyr::select(-c(instant, dteday, registered, casual))
allmod = lm(count ~., bike)
bike = bike %>% dplyr::select(-c(instant, dteday, registered, casual))
bike = bike %>% dplyr::select(-c(instant, dteday, registered, casual))
bike
allmod = lm(count ~., bike)
summary(allmod)
bike = bike %>% dplyr::select(-c(instant, dteday, registered, casual))
forwardmod = stepAIC(emptymod, direction='forward', scope=list(upper=allmod,lower=emptymod),
trace = TRUE)
summary(forwardmod)
library(MASS)
count
View(bike)
